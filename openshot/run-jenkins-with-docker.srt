1
00:00:03,382 --> 00:00:04,362
Hello大家好

2
00:00:04,372 --> 00:00:06,672
接下来由我为大家讲解Jenkins

3
00:00:06,682 --> 00:00:09,312
在容器环境下的安装和运行

4
00:00:10,282 --> 00:00:12,103
今天先给大家讲解

5
00:00:12,103 --> 00:00:14,232
Docker容器中如何安装Jenkins

6
00:00:14,892 --> 00:00:18,762
首先我们先准备一个Docker的运行环境

7
00:00:18,902 --> 00:00:22,852
用VMware虚拟出一个CentOS系统

8
00:00:22,992 --> 00:00:24,522
然后安装好Docker

9
00:00:25,122 --> 00:00:27,232
然后为Docker的容器化部署

10
00:00:27,462 --> 00:00:29,032
提供一个基础的环境

11
00:00:29,482 --> 00:00:30,692
为了方便起见

12
00:00:31,242 --> 00:00:32,899
我们通过Xshell

13
00:00:32,899 --> 00:00:35,412
然后登录这台主机

14
00:00:35,562 --> 00:00:37,702
我们可以通过docker info命令

15
00:00:37,712 --> 00:00:39,512
看见Docker已经正常启动了

16
00:00:40,592 --> 00:00:46,232
Docker在国内都是从Docker Hub上拉取镜像的

17
00:00:46,612 --> 00:00:51,532
但是我们由于网络原因可能拉取不下来

18
00:00:52,462 --> 00:00:54,812
所以我们可以配置一些

19
00:00:54,942 --> 00:00:56,062
镜像加速器

20
00:00:56,712 --> 00:01:00,502
这个在Docker官方和国内有很多云服务提供商

21
00:01:00,702 --> 00:01:03,302
都是为大家提供这种加速的服务的

22
00:01:03,312 --> 00:01:05,092
我们可以通过

23
00:01:06,002 --> 00:01:09,822
配置Docker在/etc/docker的目录

24
00:01:10,082 --> 00:01:14,142
下面有一个叫daemon.json的文件

25
00:01:14,902 --> 00:01:17,972
我们可以配置这个文件

26
00:01:18,562 --> 00:01:20,192
可以看到我已经配好了

27
00:01:20,642 --> 00:01:23,562
然后这是它的加速服务地址

28
00:01:23,622 --> 00:01:25,912
然后我们配好以后

29
00:01:26,172 --> 00:01:27,392
在docker info里头

30
00:01:27,402 --> 00:01:29,712
我们可以看到这两个地址已经生效了

31
00:01:30,012 --> 00:01:31,112
这个需要重启

32
00:01:31,472 --> 00:01:32,762
加载后生效

33
00:01:33,312 --> 00:01:42,252
然后这样我们就可以去pull Jenkins的镜像

34
00:01:44,772 --> 00:01:47,922
但是镜像由于700多兆比较大

35
00:01:47,932 --> 00:01:49,732
大家看需要一定的时间

36
00:01:49,822 --> 00:01:52,302
所以我就不去等待了

37
00:01:54,092 --> 00:01:58,022
我为大家提前下载好了镜像

38
00:01:58,882 --> 00:02:05,122
这个是下载在我的Jenkins这个目录下面

39
00:02:07,842 --> 00:02:10,352
可以看到700兆的一个tar包

40
00:02:11,122 --> 00:02:14,852
然后我们可以通过docker load的命令

41
00:02:15,272 --> 00:02:18,582
去把镜像load进来

42
00:02:28,352 --> 00:02:30,922
整个有700兆 好 load完毕

43
00:02:31,072 --> 00:02:33,502
我们可以通过docker images

44
00:02:33,512 --> 00:02:36,172
我们看到镜像已经load进来了

45
00:02:36,982 --> 00:02:39,332
然后接下来我们就拉取镜像

46
00:02:39,502 --> 00:02:41,682
拉取镜像之前

47
00:02:41,682 --> 00:02:49,652
由于Docker为了能存储容器中的一些数据

48
00:02:49,892 --> 00:02:52,382
我们在宿主机上

49
00:02:52,792 --> 00:02:59,302
可以建立镜像卷映射到容器中去

50
00:02:59,382 --> 00:03:04,362
这样就是保持这个数据一直有效

51
00:03:06,132 --> 00:03:11,832
我们建立一个目录mdir -p /jenkins

52
00:03:11,832 --> 00:03:21,012
由于容器里的Jenkins是用Jenkins用户和相应的组去建立的

53
00:03:21,402 --> 00:03:27,636
但是咱们这个目录是root用户建立的

54
00:03:27,636 --> 00:03:32,222
大家可以看到这是root用户建立的

55
00:03:32,392 --> 00:03:34,872
所以我们需要改一下属组

56
00:03:35,482 --> 00:03:37,792
容器里的Jenkins是1000

57
00:03:38,112 --> 00:03:43,382
所以我们把这个改成这个就可以了

58
00:03:44,832 --> 00:03:49,302
然后接下来我们就拉取镜像

59
00:03:49,312 --> 00:03:52,592
通过docker run的命令

60
00:03:52,822 --> 00:03:56,332
然后名字就叫jenkins

61
00:03:59,442 --> 00:04:01,962
所以由于我们需要在外部访问

62
00:04:01,972 --> 00:04:09,343
也就是说容器外去访问Jenkins

63
00:04:09,343 --> 00:04:12,432
所以我们需要把它的端口暴露出来

64
00:04:13,072 --> 00:04:15,662
容器中是8080

65
00:04:15,672 --> 00:04:18,502
我们外面为了不与其冲突

66
00:04:18,512 --> 00:04:23,292
我们可以设为8050去映射8080端口

67
00:04:23,692 --> 00:04:28,962
然后这个卷就是刚才建的jenkins

68
00:04:29,712 --> 00:04:33,642
去映射这个jenkins

69
00:04:35,732 --> 00:04:39,382
然后用jenkins这个镜像

70
00:04:44,542 --> 00:04:47,832
好 可以看到镜像建立成功了

71
00:04:47,842 --> 00:04:49,312
我们通过docker ps

72
00:04:49,372 --> 00:04:52,452
看一下这个镜像是已经没有问题了

73
00:04:52,652 --> 00:04:53,642
然后我们

74
00:04:53,832 --> 00:04:58,552
通过浏览器去访问这个地址

75
00:04:58,842 --> 00:05:01,072
端口是8050

76
00:05:02,772 --> 00:05:04,762
好 下面我们就可以看到

77
00:05:05,032 --> 00:05:07,262
Jenkins正在做初始化

78
00:05:07,272 --> 00:05:09,582
这个初始化需要一定的时间

79
00:05:09,812 --> 00:05:12,502
所以大家需要耐心的等待

80
00:05:15,522 --> 00:05:18,922
好 经过这个整个耐心的等待

81
00:05:19,202 --> 00:05:21,292
我们Jenkins的初始化完成了

82
00:05:22,312 --> 00:05:26,372
初始化后，接下来就是需要解锁Jenkins

83
00:05:26,972 --> 00:05:30,002
这个界面已经给大家可以看到提示了是吧

84
00:05:30,102 --> 00:05:31,952
为了确保管理员安全地安装Jenkins

85
00:05:31,962 --> 00:05:33,642
密码已写入到日志中

86
00:05:33,652 --> 00:05:35,362
该文件存在这个服务器上

87
00:05:35,632 --> 00:05:37,382
大家可以看到这个地址

88
00:05:38,032 --> 00:05:43,422
是我们的这个容器里的这个地址目录

89
00:05:43,432 --> 00:05:45,312
我们去获取这个地址

90
00:05:47,672 --> 00:05:54,682
我们通过docker ps然后看到这个容器

91
00:05:55,292 --> 00:06:00,172
通过docker exec -it这个命令

92
00:06:00,182 --> 00:06:02,262
然后进入到这个容器中

93
00:06:03,952 --> 00:06:08,052
可以直接写名字jenkins bash

94
00:06:08,652 --> 00:06:09,832
进入到这个容器中

95
00:06:12,672 --> 00:06:17,992
然后粘贴这个密码

96
00:06:20,752 --> 00:06:22,572
可以看到这个密码是

97
00:06:27,652 --> 00:06:28,642
拷贝下来

98
00:06:31,822 --> 00:06:33,252
然后复制在这里

99
00:06:35,092 --> 00:06:35,922
粘贴进来

100
00:06:42,182 --> 00:06:43,572
然后他是

101
00:06:43,712 --> 00:06:44,402
继续

102
00:06:44,872 --> 00:06:45,612
继续

103
00:06:46,962 --> 00:06:47,722
初始化

104
00:06:50,152 --> 00:06:51,782
接下来 Jenkins就是

105
00:06:51,792 --> 00:06:54,652
让我们选择初始化安装的插件

106
00:06:56,862 --> 00:06:57,572
我们为了方便

107
00:06:57,582 --> 00:06:59,382
因为选择插件的时候

108
00:07:00,192 --> 00:07:01,882
这个插件也是比较多

109
00:07:01,892 --> 00:07:03,412
所以我们自定义插件

110
00:07:03,622 --> 00:07:05,432
然后就是不安装插件了

111
00:07:06,822 --> 00:07:08,632
然后选择安装

112
00:07:11,932 --> 00:07:14,432
默认的就是没有安装插件

113
00:07:14,442 --> 00:07:15,432
然后Jenkins

114
00:07:18,922 --> 00:07:22,472
跳转到下一步需要创建一个管理员的帐户

115
00:07:22,902 --> 00:07:28,032
我们随便起一个名字就叫做jenkins

116
00:07:28,992 --> 00:07:32,752
密码不能跟这个相同

117
00:07:32,762 --> 00:07:39,472
jenkins123

118
00:07:41,012 --> 00:07:43,212
jenkins123

119
00:07:43,752 --> 00:07:46,822
全名就jenkins full

120
00:07:49,752 --> 00:07:51,102
保存并完成

121
00:07:53,252 --> 00:07:55,322
只配置一个Jenkins访问的地址

122
00:07:55,422 --> 00:07:57,192
这默认就使用默认地址

123
00:07:57,312 --> 00:07:58,292
保存并完成

124
00:07:59,762 --> 00:08:03,052
这样我们的Jenkins就是顺利的安装了

125
00:08:03,182 --> 00:08:05,552
下面就进入了

126
00:08:06,232 --> 00:08:08,872
Jenkins的整个运行的环境

127
00:08:10,882 --> 00:08:16,272
好 今天这个Jenkins如何在Docker容器中安装

128
00:08:16,282 --> 00:08:17,372
我们讲解完毕

129
00:08:17,432 --> 00:08:18,352
好 谢谢大家

